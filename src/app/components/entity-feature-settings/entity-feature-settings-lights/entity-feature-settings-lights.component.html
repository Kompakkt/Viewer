<h2>{{ 'Add a new light' | translate }}</h2>

<div class="add-light-list">
  <k-button full-width type="outlined-#fff" (click)="addLight('PointLight')">Point light</k-button>
  <k-button full-width type="outlined-#fff" (click)="addLight('HemisphericLight')"
    >Hemispheric light</k-button
  >
  <k-button full-width type="outlined-#fff" (click)="addLight('DirectionalLight')"
    >Directional light</k-button
  >
  <k-button full-width type="outlined-#fff" (click)="addLight('SpotLight')">Spotlight</k-button>
</div>

<h2>{{ 'Modify lights' | translate }}</h2>

<div class="light-list">
  @for (light of sceneLights(); track light; let first = $first) {
    @if (first) {
      <p>{{ 'Click a light to select and modify it' | translate }}</p>
    }

    <div
      class="light"
      (click)="selectLight(light)"
      [class.selected]="selectedSceneLight()?.id === light.id"
    >
      <h2>
        {{ light.type | splitClassName }}
        <k-button icon-button color="transparent" (click)="removeLight(light)"
          ><mat-icon>delete</mat-icon></k-button
        >
      </h2>

      <k-labelled-checkbox
        label="Enabled"
        [startingValue]="light.light.isEnabled()"
        (checkedChange)="light.light.setEnabled($event)"
      />

      <k-slider
        [label]="('Intensity' | translate) + ': ' + light.light.intensity"
        [min]="0"
        [max]="10"
        [startingValue]="light.light.intensity"
        (valueChanged)="light.light.intensity = $event"
        [showInfo]="true"
        [showTooltip]="true"
      />

      <color-chrome
        (onChange)="setLightColor(light, $event.color.rgb)"
        [color]="light.light.diffuse | colorToRgba"
        [disableAlpha]="true"
      />

      @switch (light.type) {
        @case ('SpotLight') {
          @if (light.light | isInstanceOf: SpotLight; as spotLight) {
            <k-slider
              [label]="
                ('Angle' | translate) + ': ' + ((spotLight.angle * 180) / Math.PI).toFixed(1) + 'Â°'
              "
              [min]="1"
              [max]="360"
              [startingValue]="(spotLight.angle * 180) / Math.PI"
              (valueChanged)="spotLight.angle = ($event * Math.PI) / 180"
              [showInfo]="true"
              [showTooltip]="true"
            />
          }
        }
      }
    </div>
  } @empty {
    <p>{{ 'No lights in scene. Add a light using the options above.' | translate }}</p>
  }
</div>
