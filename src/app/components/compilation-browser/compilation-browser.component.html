<ng-container *ngIf="entities$ | async as entities">
  <mat-card class="white-mat-card" *ngIf="compilation$ | async as compilation">
    <p class="center">
      <strong>{{ compilation.name }}</strong>
    </p>
  </mat-card>

  <ng-container *ngIf="entity$ | async as selectedEntity">
    <mat-card
      class="white-mat-card card-without-padding"
      *ngFor="let entity of entities"
      [class.active]="selectedEntity._id === entity._id"
    >
      <img
        class="previewimage"
        [style.--bg]="entity.settings.background.color | colorToRgba"
        *ngIf="entity.settings && entity.settings.preview"
        [src]="server_url + entity.settings.preview"
        (click)="processing.fetchAndLoad(entity._id, undefined)"
        matTooltip="Click to load"
        matTooltipPosition="after"
      />
      <mat-expansion-panel
        class="custom-expansion-panel"
        [expanded]="selectedEntity._id === entity._id"
      >
        <mat-expansion-panel-header
          class="padded-expansion-panel-header"
          matTooltip="Toggle description"
          matTooltipPosition="after"
        >
          <strong>{{ entity.name }}</strong>
        </mat-expansion-panel-header>
        <mat-expansion-panel-body>
          <small>{{ entity.relatedDigitalEntity.description }}</small>
        </mat-expansion-panel-body>
      </mat-expansion-panel>
    </mat-card>
  </ng-container>
</ng-container>
